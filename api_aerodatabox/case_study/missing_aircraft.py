import json
import os

# Load aircraft seat capacity data
aircraft_seat_capacity = {

    "Airbus  A320-100": 157,
    "Airbus  A320-200": 158,
    "Airbus  A318": 118,
    "Airbus  A300-600": 261,
    "Airbus  A300-100": 254,
    "Airbus  A310-200C/F": 186,
    "Airbus  A319": 132,
    "Airbus  A320-200n": 184,
    "Airbus  A321-200n": 191,
    "Airbus  A321/Lr": 196,
    "Airbus  A330-200": 265,
    "Airbus  A330-300/333": 292,
    "Airbus  A330-900": 280,
    "Airbus  A350-900": 304,
    "Boeing 717-200": 112,
    "Boeing 727-100": 114,
    "Boeing 737-700": 125,
    "Boeing 737-700LR": 125,
    "Boeing 737-Max 7": 125,
    "Boeing B737-300": 131,
    "Boeing B737-500": 113,
    "Boeing B767-200": 174,
    "Boeing B787-800": 226,
    "Boeing B787-900": 266,
    "Boeing  737-200C": 108,
    "Boeing  737-800": 163,
    "Boeing  737-900": 175,
    "Boeing  737-900ER": 179,
    "Boeing  747-100": 405,
    "Boeing  747SP": 248,
    "Boeing  757-300": 227,
    "Boeing  767-400": 249,
    "Boeing  777-300": 329,
    "Boeing  787-10": 318,
    "Boeing  B727-200": 149,
    "Boeing  B737 Max 800": 171,
    "Boeing  B737 Max 900": 178,
    "Boeing  B737-100": 109,
    "Boeing  B737-200": 109,
    "Boeing  B737-400": 143,
    "Boeing  B747-200": 394,
    "Boeing  B747-300": 394,
    "Boeing  B747-400": 386,
    "Boeing  B757-200": 189,
    "Boeing  B767-300": 228,
    "Boeing  B777": 273,
    "Canadair RJ-200ER /RJ-440": 49,
    "Canadair  CRJ 900": 78,
    "Canadair  RJ-700": 67,
    "Embraer Embraer 190": 99,
    "Embraer Embraer-135": 37,
    "Embraer  Embraer ERJ-175": 75,
    "Embraer  Embraer-145": 50,
    "Lockheed L1011-1/100/200": 314,
    "McDonnell Douglas DC10-30": 266,
    "McDonnell Douglas DC10-40": 292,
    "McDonnell Douglas DC9-30": 100,
    "McDonnell Douglas MD-90": 148,
    "McDonnell Douglas MD80/DC9-80": 144,
    "McDonnell Douglas  DC10-10": 284,
    "McDonnell Douglas  MD-11": 254,
    "Airbus A321 NEO": 200,
    "Embraer Phenom 300": 6,
    "Airbus A330-300": 290,
    "Airbus A380-800": 555,
    "Bombardier Challenger 350": 10,
    "Boeing 737-900": 177,
    "Boeing 737-500": 122,
    "Embraer RJ145": 50,
    "Boeing 747": 416,
    "Boeing 777-200": 317,
    "Gulfstream G650": 18,
    "Boeing 777": 317,
    "BE35": 6,
    "Gulfstream G550": 19,
    "Boeing 737 MAX 9": 193,
    "Airbus A319": 124,
    "Boeing 737": 149,
    "BAe 146-200": 100,
    "Airbus A320": 150,
    "Gulfstream Aerospace IV": 19,
    "Boeing 787-8": 242,
    "Boeing 777-300ER": 396,
    "McDonnell Douglas MD-83": 155,
    "Boeing 777-200LR": 317,
    "Boeing 737-800": 162,
    "Airbus A321": 185,
    "Boeing 737 MAX 8": 178,
    "Boeing 747-400": 416,
    "BAe 146-300": 112,
    "Embraer 190": 100,
    "Boeing 757-200": 200,
    "Airbus A330-200": 246,
    "SF50": 5,
    "Cessna 680A Citation Latitude": 9,
    "Airbus A320 (Sharklets)": 150,
    "Boeing 737-400": 150,
    "Embraer Phenom 300": 6,
    "Airbus A350-900": 325,
    "Boeing 737-300": 140,
    "Boeing 777-300": 396,
    "Embraer 175": 76,
    "Boeing 787-9": 290,
    "Airbus A320 NEO": 180,
    "Embraer 135": 37,
    "Beechcraft 300 Super King Air": 8,
    "Canadair CRJ 705": 75,
    "Boeing 767-300": 218,
    "Gulfstream G500": 19,
    "Boeing 747-100": 366,
    "Cessna 525B Citation CJ3": 8,
    "Boeing 707-300": 189,
    "Hawker 4000": 9,
    "Airbus A220-300": 145,
    "Gulfstream G200": 10,
    "Piper Archer": 4,
    "BCS3": 145,
    "Embraer 145": 50,
    "Eurocopter EC130": 7,
    "Gulfstream Aerospace G650": 18,
    "Embraer Pheom 300": 6,
    "Eurocopter EC145": 9,
    "McDonnell Douglas MD-82": 155,
    "C402": 6,
    "Global 5000": 13,
    "Airbus A380": 555,
    "Bombardier Learjet 60": 8,
    "DH8B": 78,
    "Bombardier CRJ700": 70,
    "PAY2": 7,
    "Canadair CRJ 700": 70,
    "A119": 6,
    "Fokker 70": 80,
    "Boeing 717": 110,
    "Cessna 525 Citation M2": 6,
    "Bombardier Learjet 45": 8,
    "BCS1": 108,
    "Airbus A330": 277,
    "Ilyushin IL-62": 168,
    "Challenger 300": 9,
    "Piper PA-46 Malibu": 6,
    "Bombardier Global 5000": 13,
    "Cessna 525 Citation Jet": 6,
    "Canadair CRJ 200": 50,
    "Airbus A300-600": 266,
    "ATR 42-300": 48,
    "Eurocopter EC135": 7,
    "Canadair CRJ 100": 50,
    "Diamond DA42": 4,
    "Boeing 757-200 (winglets)": 200,
    "Bombardier Learjet 40": 7,
    "Boeing 747-8": 467,
    "Airbus A220": 120,
    "AgustaWestland A-109": 6,
    "Hawker 800": 8,
    "Airbus A350": 325,
    "Challenger 350": 10,
    "BAe 125": 8,
    "Boeing 787": 242,
    "Boeing 757": 200,
    "Canadair Challenger": 10,
    "Cessna 206": 6,
    "AgustaWestland A109": 6,
    "Eurocopter AS350": 6,
    "E295": 70,
    "Bombardier Learjet 35": 8,
    "Beechcraft Premier I": 6,
    "Cessna 680 Citation Sovereign": 12,
    "Boeing 777-200F": 0,
    "Embraer 195": 108,
    "Bombardier CRJ900": 90,
    "Boeing 737-800 (winglets)": 162,
    "Boeing 727-200": 189,
    "Airbus A340-300": 295,
    "RV10": 4,
    "RV6": 2,
    "BAe Jetstream 32": 19,
    "Douglas DC-10-10": 250,
    "Beechcraft 200 Super King Air": 8,
    "De Havilland Canada DHC-8-400 Dash 8Q": 78,
    "Dassault Falcon 7X": 12,
    "Gulfstream IV": 19,
    "Cessna 525A Citation CJ2": 6,
    "Embraer 140": 44,
    "Saab 340": 34,
    "Airbus A350-1000": 366,
    "Bombardier CRJ200": 50,
    "Robinson R66": 4,
    "Airbus A330-900": 287,
    "Airbus A220-100": 120,
    "350i": 8,
    "Cessna 172": 4,
    "Learjet 45": 8,
    "Douglas DC-9-30 Freighter": 0,
    "Cessna 525C Citation CJ4": 10,
    "Boeing 747-200": 366,
    "Boeing 767-400": 245,
    "Bell 407": 5,
    "Guimbal Cabri G2": 2,
    "Embraer 170": 70,
    "Boeing 757 (winglets)": 200,
    "Beech 99 Airliner": 15,
    "Airbus A340-500": 313,
    "Airbus A300B4/C4": 266,
    "Embraer Phenom 100": 4,
    "Cessna 750 Citation X": 12,
    "De Havilland Canada DHC-6 Twin Otter": 19,
    "Cessna 560 Citation V": 8,
    "Gulfstream G450": 19,
    "Cessna Model 680 Sovereign": 12,
    "Canadair CRJ-701ER": 70,
    "Bombardier Learjet 75": 8,
    "Airbus A321 (Sharklets)": 185,
    "AgustaWestland AW139": 15,
    "Cessna 510 Citation Mustang": 4,
    "Cessna 550B Citation Bravo": 8,
    "Piaggio P.180 Avanti": 9,
    "Boeing 767-200": 181,
    "Bombardier Learjet 31": 8,
    "C295": 70,
    "TBM9": 6,
    "Embraer Legacy 600": 13,
    "Fairchild Dornier 328JET": 32,
    "Dassault Falcon 8X": 12,
    "Cessna 441 Conquest II": 9,
    "Bombardier Global Express": 19,
    "Bell 429": 7,
    "Bombardier Dash 8 Q300 / DHC-8-300": 50,
    "Socata TB-10": 4,
    "Bombardier Learjet 70": 8,
    "Cessna 680 Citation Latitude": 9,
    "M600": 6,
    "Airbus A319 NEO": 124,
    "Cessna 550": 8,
    "S22T": 4,
    "Beechcraft C90A King Air": 7,
    "Beechcraft 1900D": 19,
    "P28": 4,
    "PA32": 6,
    "BAe-125-1000": 8,
    "Dassault Falcon 50": 9,
    "Gulfstream G150": 8,
    "Cirrus SR-22": 4,
    "Bombardier Dash 8 Q400 / DHC-8-400": 78,
    "McDonnell Douglas MD-11": 323,
    "Airbus A300": 266,
    "Fairchild-Swearingen SA226": 19,
    "CASA 212 Aviocar": 26,
    "Pilatus PC-24": 8,
    "De Havilland Canada DHC-8-200 Dash 8 / 8Q": 39,
    "C700": 10,
    "Airbus A340": 295,
    "Canadair reg jet 700": 70,
    "Dornier 328": 32,
    "Boeing 720B": 149,
    "Douglas DC-10-30/30CF/30ER": 318,
    "BAe 3200 Jetstream Super": 19,
    "Airbus A318": 118,
    "Boeing 767": 218,
    "PA44": 4,
    "Pilatus PC-12": 9,
    "Gulfstream GIII": 19,
    "Bombardier Challenger 300": 9,
    "Gulfstream Aerospace V": 19,
}

# Load JSON data from files
folder_path = "airport_data"
file_names = ["RKPC.json", "RKSS.json", "RJCC.json", "RJTT.json", "RJFF.json", "VVNB.json","VVTS.json"]

flights = []
missing_models = set()

for file_name in file_names:
    file_path = os.path.join(folder_path, file_name)
    try:
        with open(file_path, 'r') as file:
            data = json.load(file)
            for flight in data:
                if isinstance(flight, dict):
                    flight['origin'] = file_name.split('.')[0]  # Add origin airport code to each flight
                    flights.append(flight)
                else:
                    print(f"Skipping malformed entry in {file_name}: {flight}")
    except json.JSONDecodeError as e:
        print(f"Error reading {file_path}: {e}")

# Check for missing aircraft models
for flight in flights:
    try:
        aircraft = flight.get("aircraft", {})
        if isinstance(aircraft, dict):
            model = aircraft.get("model")
            if model and model not in aircraft_seat_capacity:
                missing_models.add(model)
        else:
            print(f"Aircraft data is not a dictionary for flight from {flight['origin']}: {aircraft}")
    except KeyError as e:
        print(f"Missing key in flight data: {e}")

# Log missing aircraft models
if missing_models:
    with open(os.path.join(folder_path, "missing_aircraft_models.log"), 'w') as log_file:
        for model in missing_models:
            log_file.write(f"Missing aircraft model: {model}\n")

print("Processing complete. Missing aircraft models have been logged.")
